---
title: 如何设计一个好的API及其重要性
date: 2023-11-06 20:00:00 +0800
categories: [权衡质量与务实, 抽象]
tags: [抽象, API设计]     # TAG names should always be lowercase
toc: true
---

本文是 **How to Design a Good API and Why it Matters** 的中文翻译版。



《如何设计一个好的API及其重要性》 作者：约书亚 布洛赫，前谷歌首席软件工程师



## 为什么API设计重要？

* API 可以成为公司最重要的资产之一
  * 客户大量投资：购买、写作、学习
  * 停止使用 API 的成本可能令人望而却步
  * 成功的公共 API 吸引客户 
* 也可能是公司最大的负债之一
  * 差劲的 API 导致了无休止的支持呼叫
* 公开的 API 是永恒的 - 一次做对的机会

## 为什么API设计对你很重要

* 如果你编程，你就是一个API的设计者
  * 好的代码是模块化的-每个模块有一个API
* 有用的模块往往能复用
  * 一旦模块有了用户，不能再修改API
  * 好的可重用模块是企业资产
* 从 API 角度思考可提高代码质量

## 一个优秀 API 的特点

* 易学
* 易使用，甚至没有文档
* 很难误使用
* 使用它的代码易于阅读和维护
* 足够强大，满足要求
* 易扩展
* 适合观众

## 大纲

* API设计的流程
* 一般原则
* 类设计
* 方法设计
* 异常设计
* 重构API设计

## API设计的流程

### 收集需求—以健康的方式怀疑程度

* 通常您会得到建议的解决方案
  * 好的解决方案也许已经存在
* 你的工作就是提取真正的需求
  * 应采用用例的形式
* 构建更一般的东西可能更容易、更有价值

### 从简短的规格开始 ，1 页是理想的选择

* 在这个阶段，敏捷性胜过完整性
* 让尽可能多的人了解规格
  * 倾听他们的意见并认真对待
* 如果你保持短的规格，很容易修改
* 当你获得自信时，充实它
  * 这必然涉及到编码

### 尽早并经常写入您的 API

* 在实施 API 之前开始
  * 节省您执行将被丢弃的实施工作
*  在正确指定之前就开始
  * 使您无需编写将被丢弃的规格
* 充实 API 后继续写入 API
  _ 防止令人讨厌的意外
  _ 代码作为示例、单元测试继续存在

### 写入 SPI 更为重要

* 服务提供接口（SPI）
* 发布之前编写多个插件
  * 如果写一个，可能不会支持另一个
  * 如果写两个，就很难支持更多了
  * 如果写三个，工作良好
* 威尔·特拉兹（Will Tracz）称之为“三分法则”

###  保持现实的期望

* 大多数 API 设计都受到过度约束
  * 你无法取悦所有人
  * 旨在让每个人都同 样不高兴
* 预计会犯错误
  * 几年的实际使用将把它们冲走
  *  期待 API 的发展

## 一般原则

## 类设计

## 方法设计

## 异常设计

## 重构API设计
